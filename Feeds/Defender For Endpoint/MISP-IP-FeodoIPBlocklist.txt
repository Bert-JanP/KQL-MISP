let MISPFeed = externaldata(Row: string)[@"https://feodotracker.abuse.ch/downloads/ipblocklist.csv"] with (format="txt", ignoreFirstRecord=True);
let IPRegex = '[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}';
let MaliciousIP = materialize (
       MISPFeed
       | extend IP = extract(IPRegex, 0, Row)
       | where isnotempty(IP)
       | distinct IP
        );
DeviceNetworkEvents
| where RemoteIP in (MaliciousIP)
| project-reorder Timestamp, DeviceName, RemoteIP, RemotePort, InitiatingProcessAccountName